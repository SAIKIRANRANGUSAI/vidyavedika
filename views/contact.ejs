<%- include('partials/header') %>

    <div class="no-bottom no-top" id="content">
        <section id="subheader" class="breadcrumb-section text-center"
            style="background: linear-gradient(
                rgba(0, 0, 0, 0.6), 
                rgba(0, 0, 0, 0.4)
              ),url('images/breadcrumb-img.jpg'); background-size: cover; background-position: center center; min-height: 300px; display: flex; align-items: center;">
            <div class="container relative z-2">
                <div class="row align-items-center">
                    <div class="col-lg-12">
                        <h1 class="wow fadeInUp">Contact Us</h1>
                        <ul class="crumb wow fadeInDown">
                            <li><a href="/index">Home</a></li>
                            <li class="active">Contact Us</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <section>
            <div class="container">
                <div class="row g-4">
                    <div class="col-lg-6">
                        <div class="subtitle">Get In Touch</div>
                        <h2 class="wow fadeInUp"><%- getInTouch.heading
                                || "We are always ready to help you and answer your questions" %></h2>

                        <p><%- getInTouch.description
                                || "It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters, as opposed to using"
                                %></p>

                        <div class="row g-4 gx-5">

                            <div class="col-lg-6">
                                <div class="fw-bold text-dark"><i
                                        class="icofont-location-pin me-2 id-color-2"></i>Clinic Location</div>
                                <%= footerData?.contact?.location_text || "Vizag, India." %>
                            </div>

                            <div class="col-lg-6">
                                <div class="fw-bold text-dark"><i class="icofont-phone me-2 id-color-2"></i>Call Us
                                    Directly</div>
                                <% const phones=(footerData?.contact?.phone_number || "+91 98765 43210" ).split(',');
                                    phones.forEach(phone=> {
                                    %>
                                    <a href="tel:<%= phone.trim() %>">
                                        <%= phone.trim() %>
                                    </a><br>
                                    <% }) %>
                            </div>

                            <div class="col-lg-6">
                                <div class="fw-bold text-dark"><i class="icofont-envelope me-2 id-color-2"></i>Send a
                                    Message</div>
                                <% const emails=(footerData?.contact?.email_address || "info@vidyavedika.com"
                                    ).split(','); emails.forEach(email=> {
                                    %>
                                    <a href="mailto:<%= email.trim() %>">
                                        <%= email.trim() %>
                                    </a><br>
                                    <% }) %>
                            </div>

                        </div>


                    </div>

                    <div class="col-lg-6">
                        <div class="p-40 bg-color-op-1 rounded-1">
                            <h3>Get In Touch</h3>

                            <!-- Load reCAPTCHA v2 -->
                            <script src="https://www.google.com/recaptcha/api.js" async defer></script>

                            <form id="contactForm" method="POST">
                                <div class="mb-4">
                                    <input type="text" name="name" id="name" class="form-control"
                                        placeholder="Your Name" required>
                                </div>

                                <div class="mb-4">
                                    <input type="email" name="email" id="email" class="form-control"
                                        placeholder="Your Email" required>
                                </div>

                                <div class="mb-4">
                                    <input type="text" name="phone" id="phone" class="form-control"
                                        placeholder="Your Phone" required>
                                </div>

                                <div class="mb-4 mb20">
                                    <textarea name="message" id="message" class="form-control"
                                        placeholder="Your Message" required></textarea>
                                </div>

                                <!-- âœ… v2 reCAPTCHA checkbox -->
                                <div class="mb-4">
                                    <div class="g-recaptcha" data-sitekey="6Lc_pM0rAAAAAIypZSI3uwl1xyukAAbFen-VA9K4">
                                    </div>
                                </div>

                                <div id="submit" class="mt20">
                                    <input type="submit" id="send_message" value="Send Message" class="btn-main">
                                </div>
                            </form>

                            <!-- Popup message -->
                            <div id="contactMessage" style="display:none; margin-top:10px;"></div>
                        </div>
                    </div>
                    <script>
                        document.getElementById("contactForm").addEventListener("submit", async function (e) {
                            e.preventDefault();

                            const form = e.target;
                            const formData = new FormData(form);
                            const data = Object.fromEntries(formData.entries());

                            // Get reCAPTCHA response
                            data["g-recaptcha-response"] = grecaptcha.getResponse();

                            const messageDiv = document.getElementById("contactMessage");
                            messageDiv.style.display = "block";
                            messageDiv.style.padding = "10px";
                            messageDiv.style.borderRadius = "5px";

                            try {
                                const response = await fetch("/contact-us/send", {
                                    method: "POST",
                                    headers: { "Content-Type": "application/json" },
                                    body: JSON.stringify(data)
                                });

                                const result = await response.json();

                                if (result.success) {
                                    messageDiv.style.backgroundColor = "#d4edda";
                                    messageDiv.style.color = "#155724";
                                    messageDiv.innerText = result.message;
                                    form.reset();
                                    grecaptcha.reset();
                                } else {
                                    messageDiv.style.backgroundColor = "#f8d7da";
                                    messageDiv.style.color = "#721c24";
                                    messageDiv.innerText = result.message;
                                }

                            } catch (err) {
                                console.error(err);
                                messageDiv.style.backgroundColor = "#f8d7da";
                                messageDiv.style.color = "#721c24";
                                messageDiv.innerText = "Server error. Please try again.";
                            }
                        });
                    </script>



                </div>
            </div>
        </section>
    </div>
    <%- include('partials/footer') %>
